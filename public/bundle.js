!function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);class s{constructor(){this._element=null}getTemplate(){throw new Error("not on abstract class")}createElement(t){const e=document.createElement("div");return e.innerHTML=t,e.firstChild}getElement(){return this._element||(this._element=this.createElement(this.getTemplate())),this._element}deleteElement(){this._element=null}}class r extends s{constructor(t){super(),this._type=t}getTemplate(){return`<button class="button button--new button--${t=this._type}">+ add another ${t}</button>`;var t}onNewButtonClick(t){this.getElement().parentElement.querySelector(".button--"+this._type).addEventListener("click",t)}}class i extends s{constructor(t){super(),this._listID=t}getTemplate(){return`<div class="group group--new group--list" data-value="listID--${this._listID}">\n      <input type="text" name="new" id="newItem" class="input user-list-input" placeholder="enter new list name..." autocomplete="off">\n      <div class="group group--buttons">\n        <button class="button button--add">add</button>\n        <button class="button button--service button--cancel">X</button>\n      </div>\n    </div>`}onAddbuttonClick(t){this.getElement().querySelector(".button--add").addEventListener("click",t)}onCancelButoonClick(t){this.getElement().querySelector(".button--cancel").addEventListener("click",t)}}class o extends s{constructor(t,e){super(),this._index=t,this._listName=e}getTemplate(){return t=this._listName,`<ul class="taskList" id="${this._index}">\n      <input class="taskList__name" value="${t}" autocomplete="off">\n      <button class="button button--service button--delete">&#128465</button>\n    </ul>`;var t}onNewButtonClick(t){this.getElement().querySelector(".button--card").addEventListener("click",t)}onDeleteButoonClick(t){this.getElement().querySelector(".button--delete").addEventListener("click",t)}onHeadingMouseMove(t){this.getElement().querySelector(".taskList__name").addEventListener("mousedown",t)}onInputChange(t){this.getElement().querySelector(".taskList__name").addEventListener("change",t)}}class l extends s{constructor(t,e){super(),this._previousInput=e,this._cardID=t}getTemplate(){return t=this._cardID,e=this._previousInput,`<div class="group group--new group--edit" data-value="cardID--${t}">\n      <textarea name="" id="" cols="30" rows="5" class="edit-textarea user-card-input" placeholder="enter your task...">${e}</textarea>\n      <div class="group group--buttons">\n        <button class="button button--add button--edit">edit</button>\n        <button class="button button--service button--cancel button--editcancel">X</button>\n        <button class="button button--service button--editdelete">&#128465</button>\n      </div>\n    </div>`;var t,e}onEditButtonClick(t){this.getElement().querySelector(".button--edit").addEventListener("click",t)}onEditCancelButtonClick(t){this.getElement().querySelector(".button--editcancel").addEventListener("click",t)}onEditDeleteButtonClick(t){this.getElement().querySelector(".button--editdelete").addEventListener("click",t)}}class a extends s{constructor(t,e){super(),this._index=t,this._text=e}getTemplate(){return t=this._index,e=this._text,`<li class="card card--${t}" id="${t}">\n      <button class="button button--service button--edit">&#128394;</button>\n      <p class="card__text">${e}</p>\n    </li>`;var t,e}onEditButoonClick(t){this.getElement().querySelector(".button--edit").addEventListener("click",t)}onMouseDown(t){this.getElement().addEventListener("mousedown",t)}}class c{static hideButton(t){t.style.display="none"}static showButton(t){t.style.display="block"}static deleteBlock(t,e){t.querySelector(e).remove()}static deleteNode(t,e){t.querySelector(e).remove()}static getUserInput(t,e){return t.querySelector(e).value}static getPreviousInput(t,e){return t.querySelector(e).textContent}static setIndex(t){let e;return e=t||0,e}static resetIndex(t){t.forEach((t,e)=>{Object.prototype.hasOwnProperty.call(t,"listID")?t.listID=e:t.cardID=e})}static resetListStorage(t){localStorage.clear(),t.forEach(t=>{const e={listID:t.listID,h3:t.h3,cardAmount:t.cardAmount,cards:t.cards},n=e.listID+"--list";localStorage.setItem(n,JSON.stringify(e))})}static resetCardStorage(t,e){const n=JSON.parse(localStorage.getItem(t+"--list"));n.cards=e,localStorage.setItem(t+"--list",JSON.stringify(n))}static resetNodeIndex(t){for(let e=0;e<t.length;e+=1)t[e].id=e}static moveElement(t,e,n,s){let r;r=e instanceof o?t.clientX:t.clientY,e.getElement().style.zIndex="1";const i=t=>{let n;t.preventDefault(),n=e instanceof o?r-t.clientX:r-t.clientY,e instanceof o?e.getElement().style.right=n+"px":e.getElement().style.bottom=n+"px"},l=t=>{let r,a,c,u;t.preventDefault(),e instanceof o?(r=e.getElement().style.right.slice(0,-2),a=Array.from(t.currentTarget.parentElement.querySelectorAll(".taskList")),c=a.findIndex(e=>e.id===t.currentTarget.id),u=t.currentTarget.parentElement.querySelectorAll(".taskList")):(r=e.getElement().style.bottom.slice(0,-2),a=Array.from(t.currentTarget.parentElement.querySelectorAll(".card")),c=a.findIndex(e=>e.id===t.currentTarget.id),u=t.currentTarget.parentElement.querySelectorAll(".card"));const d=()=>{e instanceof o?e.getElement().style.right="0px":e.getElement().style.bottom="0px"},h=t=>{e instanceof o?this.resetListStorage(s):this.resetCardStorage(t,s)};if(r<=0)if(r>=-50||u.length-1===c)d();else{const t=n.replaceChild(u[c],u[c+1]);n.insertBefore(t,u[c]),[u[c].id,u[c+1].id]=[u[c+1].id,u[c].id],[s[c],s[c+1]]=[s[c+1],s[c]],this.resetIndex(s),h(u[c].parentElement.id),d()}if(r>0)if(r<50||"0"===e.getElement().id)d();else{const t=n.replaceChild(u[c],u[c-1]);u[c].after(t),[u[c].id,u[c-1].id]=[u[c-1].id,u[c].id],[s[c],s[c-1]]=[s[c-1],s[c]],this.resetIndex(s),h(u[c].parentElement.id),d()}e.getElement().style.zIndex="0",e.getElement().removeEventListener("mousemove",i),e.getElement().removeEventListener("mouseup",l)};e.getElement().addEventListener("mousemove",i),e.getElement().addEventListener("mouseup",l)}}class u{constructor(t,e){this._newButton=new r("card"),this._listElement=t,this._listData=e,this._cardAmount=this._listData.cardAmount,this._cardArr=this._listData.cards}render(){this._renderNewButton(),this._renderStorage()}_renderNewButton(){this._newButton.onNewButtonClick(()=>{c.hideButton(this._newButton.getElement());const t=c.setIndex(this._cardArr.length);this._createBlock(t,"")}),this._listElement.append(this._newButton.getElement())}_renderStorage(){this._cardArr.forEach(t=>{const e=new a(t.cardID,t.cardText);e.onEditButoonClick(n=>{const s=n.target.nextElementSibling.textContent;e.getElement().remove(),this._createBlock(t.cardID,s)}),e.onMouseDown(t=>{c.moveElement(t,e,this._listElement,this._cardArr)}),this._listElement.insertBefore(e.getElement(),this._listElement.lastChild)})}_createBlock(t,e){const n=new l(t,e);n.onEditButtonClick(()=>{const e=c.getUserInput(this._listElement,".user-card-input");e?(this._listData.editCardInlocalDATA(t,e),this._createCard(t,e),this._resetBlock(),this._cardAmount+=1):this._resetBlock()}),n.onEditCancelButtonClick(()=>{if(e){const e=c.getPreviousInput(this._listElement,".user-card-input");this._createCard(t,e),this._resetBlock(),this._cardAmount+=1}else this._resetBlock()}),n.onEditDeleteButtonClick(()=>{e?(this._cardArr.splice(t,1),c.resetIndex(this._cardArr),this._listData.deleteCardFromLocalDATA(t),c.resetCardStorage(this._listData.listID,this._cardArr),c.resetNodeIndex(this._listElement.querySelectorAll(".card")),this._resetBlock(),this._cardAmount-=1):this._resetBlock()}),t+1===this._cardArr.length?this._listElement.insertBefore(n.getElement(),this._listElement.lastChild):this._listElement.insertBefore(n.getElement(),this._listElement.querySelector(".card--"+(t+1)))}_createCard(t,e){const n=new a(t,e);n.onEditButoonClick(e=>{const s=e.target.nextElementSibling.textContent;n.getElement().remove(),this._createBlock(t,s)}),n.onMouseDown(t=>{c.moveElement(t,n,this._listElement)}),this._cardArr.some(e=>e.cardID===t)||this._cardArr.push({cardID:t,userInput:e}),t+1===this._cardArr.length?this._listElement.insertBefore(n.getElement(),this._listElement.querySelector(".button--new")):this._listElement.insertBefore(n.getElement(),this._listElement.querySelector(".card--"+(t+1)))}_resetBlock(){c.deleteBlock(this._listElement,".group--edit"),c.showButton(this._newButton.getElement())}}class d{constructor(t,e,n,s){this.listID=t,this.h3=e,this.cardAmount=n,this.cards=s,this.keyName=this.listID+"--list"}createListInLocalDATA(){const t={listID:this.listID,h3:this.h3,cardAmount:this.cardAmount,cards:this.cards};localStorage.setItem(this.keyName,JSON.stringify(t))}deleteListFormLocalDATA(){localStorage.removeItem(this.keyName)}editCardInlocalDATA(t,e){const n=this._getObjFromLocalData();n.cards.some(e=>e.cardID===t)?n.cards[t]={cardID:t,cardText:e}:(n.cards.push({cardID:t,cardText:e}),n.cardAmount+=1),this.cards=n.cards,localStorage.setItem(this.keyName,JSON.stringify(n))}deleteCardFromLocalDATA(t){const e=this._getObjFromLocalData();e.cards.splice(t,1),e.cardAmount-=1,this.cards=e.cards,localStorage.setItem(this.keyName,JSON.stringify(e))}_getObjFromLocalData(){return JSON.parse(localStorage.getItem(this.keyName))}}const h=document.querySelector(".app");class m{constructor(){this._newButton=new r("list"),this._listAmount=localStorage.length,this._listArr=[]}start(){this._renderNewButton(),this._renderStorage()}_renderNewButton(){this._newButton.onNewButtonClick(()=>{c.hideButton(this._newButton.getElement());const t=c.setIndex(this._listArr.length);this._createBlock(t)}),h.append(this._newButton.getElement())}_renderStorage(){const t=[];for(let e=0;e<localStorage.length;e+=1){const n=localStorage.key(e);if(-1!==n.indexOf("--list")){const e=JSON.parse(localStorage.getItem(n)),s=e.listID,r=e.h3,i=e.cardAmount,o=e.cards,l=new d(s,r,i,o);t.push(l)}}t.sort((t,e)=>t.listID-e.listID),this._listArr=t,t.forEach(t=>{this._createNewList(t)})}_createBlock(t){const e=new i(t);e.onAddbuttonClick(()=>{const e=c.getUserInput(document,".user-list-input");if(e){const n=new d(t,e,0,[]);this._listArr.push(n),n.createListInLocalDATA(),this._createNewList(n),this._resetBlock(),this._listAmount+=1}else this._resetBlock()}),e.onCancelButoonClick(()=>{this._resetBlock()}),h.append(e.getElement())}_createNewList(t){const e=new o(t.listID,t.h3);e.onDeleteButoonClick(()=>{document.getElementById(t.listID).remove(),this._listArr.splice(t.listID,1),c.resetIndex(this._listArr),t.deleteListFormLocalDATA(),c.resetListStorage(this._listArr),c.resetNodeIndex(document.querySelectorAll(".taskList")),this._listAmount-=1}),e.onInputChange(e=>{t.h3=e.target.value;const n=e.target.parentElement.id,s=JSON.parse(localStorage.getItem(n+"--list"));localStorage.removeItem(n+"--list"),s.h3=e.target.value,localStorage.setItem(n+"--list",JSON.stringify(s))}),e.onHeadingMouseMove(t=>{c.moveElement(t,e,h,this._listArr)}),h.insertBefore(e.getElement(),this._newButton.getElement()),new u(e.getElement(),t).render()}_resetBlock(){c.deleteBlock(document,".group--list"),c.showButton(this._newButton.getElement())}}(new class{constructor(){this.board=new m}start(){this.board.start()}}).start()}]);
//# sourceMappingURL=bundle.js.map